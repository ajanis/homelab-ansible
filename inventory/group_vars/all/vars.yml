---

####################################
##### Shared Base Configuration ####
####################################

www_domain: home.prettybaked.com
timezone: America/Denver
root_password: "{{ vault_root_password }}"
root_password_salt: "{{ vault_root_passworsd_salt }}"
enable_autoupdate: true

### Postgres
postgres_default_db: home-assistant

####################################
## Shared Directory Configuration ##
####################################
shared_storage: true
storage_backend: cephfs
data_mount_root: /data
media_directory: ""
www_directory: /var/www/html
backup_directory: backups
ldap_user_home_directory: homedirs
surveillance_directory: surveillance
git_directory: git
network_directory: network
configs_directory: configs
automation_directoary: automation
automation_mounted_directory: "{{ data_mount_root }}/{{ automation_directory }}"
ftpusers_directory: "{{ data_mount_root }}/ftp"
ftp_config_directory: "{{ ftpusers_directory }}/config"

####################################
####### LDAP AND USER CONFIGS ######
####################################

#### LDAP
openldap_server_domain_name: ldap.home.prettybaked.com
openldap_server_ip: 10.0.10.15
openldap_server_uri: ldap://{{ openldap_server_ip }}
openldap_server_rootpw: "{{ vault_openldap_server_rootpw }}"
openldap_server_enable_tls: false
openldap_server_enable_sshkeys: true
openldap_server_enable_samba: false
openldap_server_enable_afpd: false
afp_ldap_auth: false
openldap_server_enable_autofs: true
openldap_client_enable: true
openldap_server_hosts_entry: "{{ openldap_server_ip }} {{ openldap_server_domain_name }} ldap"

### USERS/SSH
ajanis_pw: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38616664363838663266383964623361623564396430363634313834633865366131366334626264
  6162366237636261323233303866396461383532346364330a366666636637343339626631636636
  31316633643839366463646533663963316236666661313630383134636364373562386634303835
  6462343934333038350a663638613139316632626338336338363536313737326538646435613966
  3137

vault_ajanis_ed25519_pubkey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  34636364373434303766623333663634393935663334383838313061303530306636646164616230
  6630343631373562393563333339366662633034616235340a616539356634336564313136363364
  38663765363763633631653033353063383838643263323537643365616363363166316162356163
  3265643066633132660a303637333733316133613730643430333763326130623065303932373130
  64353436653662393731386138653361306434666334366536366135313430613364653562666237
  61306239343963616366386639356262623435376337353563303032353661363965306266373761
  35636562353162343565643238663663623034373231303131343762336536666130363166646334
  30616236666364303832356133323536616138613764636536303332633130616333393533626531
  3331
vault_ajanis_rsa_pubkey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  36333764336435313830316537333332623532663139343436616135373534366633323931613862
  6466626630323261643663323232376336386434343566650a346138646634333961653830333538
  66393063316530363037316132383339323061316234323861383739353934626239396130613439
  3734353439386538300a336138316338396463623030383138306666653835336635393639346635
  38333463333135623061343064363164313363386533386435363932363461636662656663353738
  32643936613466366363336437653837333030373162326234366333646139326136353766356338
  36333361656239656631313965316466623038346361616164396439616338643832666261333335
  38653065323237663738653035656531396234616635626533393165643733303365633431666664
  35643866306561336262376538663238663432643263653730613364373938313233333161366232
  39633961353233386136656265326233323636633463666366326631393065303038636133373166
  63613665396536616162333538366265343334363037353537366164386130666330376261666335
  39323633626437386236373938356235666564333663363032336565323438323734633631616265
  37356334383439643434303135373439616633656438303461393034373666346438356336303531
  63633231333031393865333739633234326165643164336536313465303230623834326363303835
  38613262623435383865616664313965336334386638326164623130393239343962373963396361
  63343731353232363631393132393833353262633362643238353230333964363832626261386465
  32623263373563383865303661366362306532356634396534646635396139386561343539303666
  34326236656438323133366435653266613934316330316335343236303364316163383636333637
  65316138393235313834353038636435626238653865613363623234383765376331646133343630
  63613436663465323164663361373966343737333438343132666536653639363161633232616432
  31366636376332376636366331613432636566353036383338633836313862643231636561343866
  36396162646136643863656365386130626332303031366332643737633133393637616239333463
  61623933383364383032653434383963326363386263326330333062396235656638393733366431
  35343163333639303466316161346133626136363237386138323030623630613034613234313634
  37646530653834653532363939613464346166396636353563343861336164613435666566313134
  30333035633334383136626439396366393531666465623864613163656230343633376430616336
  66303463343631613532663739373137663435323133633236636164663430616565346131666534
  34643565636630656333333763343461333964313731643531623331356162376239343633663461
  31323761323432333434646338376134616461303365363535333636343262333361333866356435
  61343338396466653164313961346435663334663262636666333861336534633739356630366635
  66393033623036376464393035623539373237366138343937373163616561323833333966356637
  66393039633935326232663265343030623763316130333764666466333831333937303362643130
  35376462323661616234366266373337353965363564646232383365383335303166643861373935
  63393861343838306162616162663936323836663738336163613164666336623630306637343830
  32376563663432326538616435303964663564616532626336623131353565313137626566356162
  62623561343834636636373532623633366362353365366663323464383631353563363663346431
  66396261373630663131393932633437303335333261643361666332303364393963623665303563
  35633339623536663138613939323338313265396136323363613463316539343730643962373936
  37346466616335323761363663316232636536663864326136663339666365303763336530363336
  31393236303536396563313534333632653330383832333838323939386462353035393639313361
  3535

www_user_pw: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  63666232633161373063336634643437653564643736663732306638373662346635313764653131
  6537336438383337383839613762663334656536643535340a346362626330623234613534356162
  64306538313861633663666136636439383064636235396535333538663332653130346336633536
  3937393434663338360a636566383362303265346531306534623463373064633038306536383062
  38376335633865356335353937356566393031623434646434333963653839366533

tglenn_pw: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  64643938626534393662333832653165633562393332656363366535626435653533333539613336
  3033396532393036353461343337316437386338373039350a616136646535653064646238353837
  31326133643530396330323839326533303363363265656666663334646235386431323035353331
  3930613861346261610a393433383861376635616230653134303633306162353136663361623561
  6436

vault_tglenn_rsa_pubkey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38396134623666323133326165396234313663373236303531373465386233613631306361303436
  3730613934326335396536393766646135396566613535310a386537653535643561326130313261
  62323236383937383465386265313033623337383737633234663134366636356333303531653361
  6335333839323830650a666264633130306534346365616139326635643832313733666438326565
  33623530353232663732333234363464373433613336653963633639373762336464656466396266
  35383233666237363136653665306333646166636335313934633132623434653964666632323337
  39373635356135373662623137653936663461653334343863373634393261633364356465383365
  34386635633637646332303936333536386538333433333930346461663336623832636665396139
  35313331353965373137306433666566646664623931663566653839656165623462636434393036
  32613264336539663036613563306233356331643862636363393630353332613862326336373231
  66333832626537306235346530393530623664643234363436333164363637663338333161346566
  38313232343366323636633163353436343637313561656234333465373335633935343236303834
  34626136373561306233346332626631653135383533643361306561396432373132366165306365
  37366161643432383633363739343766656133343435316537626461343038383466666461623131
  30363635303234363861363931646537373038393530633330386339343066646431636366626336
  32623161353936363665393962653361383361666530633963656135373937333438623263326634
  33316462366138373537613539396639613138386439383637333365613565356639306237326362
  32636665633431303361326564316537613132643565396631313362363734633433303131376438
  31373364376338623466303132306533363838373335326439646432343535363363656238646332
  32626331643362393362353066663836333635663064616330366533313762626266356539633938
  39623761306464643239333063393836653533643238343139616432616634306636336633623839
  64633035333338383962386430313164616531653831353862396462663262353066613639353837
  31383539616664633531666436373130396139623634623938363765323661333231383437343531
  36653037346264616564

vault_network_ed25519_pubkey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38343735326632366530633436316162323230653338666666623831353962373865353933356330
  3666626166383063643737623839343961623436613333350a643164643966313130396535393034
  66326265306161373437396230346666303933636366646538366533663662633961313739303030
  3634633738636338300a363461666632316136333861346630376533353337653562313632613031
  36646436383736646134393764373038393733376531336261653261323764646533643337646636
  33643766633864663963633236316530633933663736356138633431613265653139363666663937
  30666532333065633231366538366562633939303737343361396435623533653139313833306465
  63633162363866646434373837383331336662396562393763643339383062323765316333306336
  64393264303265353765626238376535316235393162616231386136383139383931
vault_imported_rsa_pubkey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  33303038653264383561636264633430323363323139636135313734313264356632313963323336
  6631666563646164646665366433373732313332623931650a666636633535316666663764646239
  61323065643730313231616338383739313533633466346536343436316462383332376430633030
  3034326236663230650a333231323136333261333538366230346664343831333637396431376137
  61326136656434373661643034346566626266393038356566623733656135373239663033336333
  38313664376265343764616235313562643131393833616561303931623235326433613663393966
  39353930616262616666636131363161353136383633313539653332346134643934313734633731
  38643237323632623538353262303838626263333230316464636439386563633332383661376466
  62653931316161633064633338343838396632316538613235386136346233313534626166333663
  30316433626166346238323239643964333235396336623066633534613336626362366466323838
  36343466623730663063643036613363653835353866666363626232623162306436313762643333
  61346130343738376663373065663539613033356661313663353839666239396437373336396635
  34373465303730376463303235343634633263386136336531313038316330333335616339643635
  62643135346639353631376262623439343033636334333163626437363265373635623363313665
  34373830383664303931383864386138306430396639636532626634346631393338343833633132
  39613834653833636135363637386536393235643931366434656261383730376562396231326435
  63373362666336356362613661393762366639383335653332656331613735656137376361323634
  61343730653530383436636334663934313633376239373134663839653437623532333766333136
  61303135613935306232643364316134633466343365646163336431623362633739633461303536
  62313634336135333366613038306361393539353365336364616463353336353835366637366538
  35353133393439383333653035373561666461663336646334303663636130333631636432313262
  62666332356536313032396663626232313931613366613138326632636531613135326132613230
  37383364653031656565336631646234333534643330353636653039626566316431343339366165
  31316439373632373932333861353665663631613737323665613733306232316436626435303838
  36353862626337326339356233633761303533663564663265636139633135626566313563356366
  33313038626636613563373063326434366665646165366664313535633634333665656638666234
  33363163373538386334333665316266333335613437643563373736383638623630626364353733
  64383038326466336661373030653866623136343034373536623833316338313466386166613433
  32376238393134383336626132653166396133656565663231353337316436653462333363336134
  62666233343734326162623061363935363238666431333335653361396331633561333238323633
  33346166396464636464396430306239386665643666306632626335313665386336306661666431
  64633335323739343332353737623631353931366166643436383835373931383430323462323866
  62363865613835653338393565313161386634323236313430313234653966653136363134653466
  39393166336533366433646630626664646238613964633466383062633936333738356236613762
  31613734333134333434623464623535663233366530616238636134616134616531616330363763
  35356438316237613430643033333832323463623538343163376230346336336333663331666366
  34626333343566353534346566643064636565323438663930653266613238316231643237396537
  64353532313039663232623232306535623661616537313836666639613836383164326161376566
  35313663663330386265613438306636333439346261373034373366633038323136333263326530
  31363466666230613863633237333066323134633536653430623635396435346537343266313364
  65326362343965643634653239336662636132313839393937633734643830306537

sshd_permit_root_login: "yes"

ssh_users:
  ajanis:
    password: "{{ ajanis_pw }}"
    cn: Alan Janis
    givenname: Alan
    sn: Janis
    mail: alan.janis@gmail.com
    shell: /bin/bash
    gecos: ajanis
    uid: 1043
    gid: 1042
    pubkey:
      - "{{ vault_ajanis_ed25519_pubkey }}"
      - "{{ vault_ajanis_rsa_pubkey }}"
      - "{{ vault_imported_rsa_pubkey }}"
      - "{{ vault_network_ed25519_pubkey }}"
    state: present
  tglenn:
    password: "{{ tglenn_pw }}"
    cn: Teagan Glenn
    givenname: Teagan
    sn: Glenn
    mail: teagan.m.glenn@gmail.com
    gecos: tglenn
    shell: /bin/bash
    uid: 1042
    gid: 1042
    pubkey:
      - "{{ vault_tglenn_rsa_pubkey }}"
      - "{{ vault_imported_rsa_pubkey }}"
      - "{{ vault_network_ed25519_pubkey }}"
    state: present
  media:
    password: "{{ vault_media_pw }}"
    cn: Media User
    givenname: Media
    sn: User
    mail: alan.janis@gmail.com
    gecos: media
    uid: 2000
    gid: 2000
    pubkey:
      - "{{ vault_network_ed25519_pubkey }}"
      - "{{ vault_imported_rsa_pubkey }}"
    state: present
  automation:
    password: "{{ vault_automation_pw }}"
    cn: Automation User
    givenname: Automation
    sn: User
    mail: teagan.m.glenn@gmail.com
    gecos: automation
    uid: 2001
    gid: 2001
    pubkey:
      - "{{ vault_tglenn_rsa_pubkey }}"
      - "{{ vault_network_ed25519_pubkey }}"
    state: present
  www-user:
    password: "{{ www_user_pw }}"
    cn: LDAP User for public_html data
    givenname: www
    sn: user
    mail: alan.janis@gmail.com
    gecos: www-user
    uid: 1999
    gid: 1999
    pubkey:
      - "{{ vault_network_ed25519_pubkey }}"
      - "{{ vault_imported_rsa_pubkey }}"
    state: present

ssh_groups:
  admin:
    description: Administrators Group
    gid: 1042
    members:
      - ajanis
      - tglenn
  users:
    description: SSH Users Group
    gid: 2002
    members:
      - ajanis
      - tglenn

  automation:
    description: Automation Services Group
    gid: 2001
    members:
      - ajanis
      - tglenn
      - automation
  media:
    description: Media Services Group
    gid: 2000
    members:
      - ajanis
      - tglenn
      - media
  www-group:
    description: LDAP Group for public_html data
    gid: 1999
    members:
      - www-user
      - ajanis
      - tglenn

####################################
##### SSL SHARED CONFIGURATION #####
####################################

### SSL
ssl_privkey: "{{ encoded_ssl_key | b64decode }}"
ssl_keypath: /etc/ssl/private/{{ www_domain }}.key
ssl_certchain: "{{ encoded_ssl_cert | b64decode }}"
ssl_certpath: /etc/ssl/certs/{{ www_domain }}.crt

####################################
##### Acme SSL Configuration #######
####################################
slurp_ssl_keys_from_remote: true
ssl_slurp_remote_host: nginx01.home.prettybaked.com
ssl_key_slurp_path: /data/ssl/prettybaked.com_ecc/prettybaked.com.key
ssl_cert_slurp_path: /data/ssl/prettybaked.com_ecc/fullchain.cer
ssl_acme_letsencrypt_config_archive: include/acme-letsencrypt.zip
ssl_acme_letsencrypt_archive_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  65613732366464333032356336666235643136633164653035623362356330353939663132623635
  3634623762343131373733383538616133313333376339300a666263633033363265653962626135
  31353532643465373237306434613464353463343562323563666237393237666538626464623966
  6437353638643336640a376139373164393235343364626461326330363034356634316633303438
  6131

####################################
### Media Services Configuration ###
####################################

### MEDIA USER
nginx_user: media
nginx_group: media

###  THEME PARK THEME
tp_theme: dark
tp_community_theme: "false"
### MEDIA SHARED DIRECTORIES
media_root: "{{ data_mount_root }}"
media_user_uid: "{{ ssh_users.media.uid }}"
media_user_gid: "{{ ssh_users.media.gid }}"
media_queue_root: /data/queued
media_watch_root: /data/watch
nginx_default_docroot: /var/www/html
media_transcode_root: /data/transcode

root_incomplete_download_directory: /data/incomplete
root_complete_download_directory: /data/complete

usenet_incomplete_download_directory: "{{ root_incomplete_download_directory }}"
usenet_complete_download_directory: "{{ root_complete_download_directory }}"
usenet_watch_directory: "{{ media_watch_root }}/usenet"

torrent_incomplete_download_directory: "{{ usenet_incomplete_download_directory }}"
torrent_complete_download_directory: "{{ usenet_complete_download_directory }}"
torrent_watch_directory: "{{ media_watch_root }}/torrent"

makemkv_media_directory: "{{ usenet_complete_download_directory }}"
makemkv_queue_directory: "{{ usenet_incomplete_download_directory }}/makemkv"

youtube_download_directory: "{{ usenet_incomplete_download_directory }}"
youtube_complete_directory: "{{ usenet_complete_download_directory }}"

plex_transcode_disk: false
plex_transcode_disk_mnt: /transcode
root_complete_transcode_directory: /data/transcoding
plex_transcode_disk_mode: "0774"
plex_server_ip: 10.0.10.175
plex_username: devicenull
plex_password: "{{ vault_plex_password }}"
plex_token: "{{ vault_plex_token }}"

tdarr_transcode_disk: false
tdarr_transcode_disk_mnt: /media/transcode
tdarr_transcode_disk_mode: "0774"

youtube_apikey: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  35303166383333646137633332373165623232666132356537636635616531626535393165336534
  3336623362303866636663656166333139653862633563330a616563636461343261643839303064
  32336435393635653365643465373261376230616230363763643030303734363066623433373763
  3638663362363163370a656439643061613764333439623237653836393964643737373264633037
  34373364356632393265623737396664656162386137356662353630316266303738333032616562
  6663643431343831313665363135313438393764386138643433

makemkv_key: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  30363263373264386139633733666434383632336462366532666130383139343363313632363166
  6237386632353734326562386666643533343733653036640a383039393032646133663765336239
  36353333626138383563326136333433643632303663393962663734343839336661386437396466
  6234616435313363620a383437353735346261356162303733643333653631656563343730333334
  39313366363934613662353333313461666565353433373533306662393066663933636561356432
  65666464346633393838323932376238393165356666343833353930393432646339653464636636
  32353130373663613737313136326239333664323064646235376230373965313962343264393431
  37643931303464313661

####################################
##### Telegraf Configuration #######
####################################

telegraf_runas_user: root
telegraf_runas_group: root

vault_influxdb2_init_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  61326465653236356231316138623766623261393963303836613230653730363036373665616562
  3331386466613931393461383338663165653365396135620a373931663663383336306230303333
  30343238656463353330303265386533613361363764393038323936393638663437396566353862
  3338393465373962350a313935333432316133616539303962383466653539616565323666346663
  6663
vault_influxdb2_init_admin_token: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  61623034316437646632626265303631383339313534666166356266316232393732386330646534
  6632636565363437346137623565643936613466353265380a323865616135386433306235613336
  39616162663130313036383963353862663133396665386363326439356461363234653161303165
  3137646162343530390a366332323664656539393762363163656364383732633936313234323735
  34353734346234316635333364356233623464323861653436646363633035613763353937303739
  65333366333238323431316430376636353639343938663664363837663539373438636338306536
  32353030613436343863626361366136616630626536616564646561623166366661633730383161
  64353433326538393235646434336334393661306139656139333635353666383663653766336535
  3666
vault_influxdb2_telegraf_token: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  37633238316336333534343937333130363536613530326662336561633530366562303035373036
  6262616330393566393831316637306463623065636662650a336665656266386637626531326635
  32633934363737383265326362383137613365333763373062376532363738393931313634643164
  3530646364356537390a643031323831313130653334386335383234643937363366383035353031
  36613563623436653438313133323436666235313539383132613835343038616265343237663732
  39663633663564636131393965386631386337616539356563383464363939386663343935396139
  37353234366438313563336666303961613762326561313830643265376266316464656439616666
  61383433376338323431363736396537636533323363383936663862333133323362303366393463
  3330

vault_influxdb2_token: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  62623030653936333633353230666262363465643863376337313832333837666363663339373131
  6565363466343937646530386162303965373563346630650a333263343365393163326165623630
  30373538336237363931643038326266366639633432363935363933623039656539376439383630
  6331333162643361630a613039303962303830383961306565363135383963646365626433373739
  61383965346630356263383339393230376163363436366166383239303837646238323335396361
  37383965633130663863326633353564653637313237313532336636386166326233326134663830
  62636633383862646334393634346635393936306462303831666432396363353736653032366235
  65373833363864643265373361333039633765303838343661323235616332643465333739346639
  3265

telegraf_agent_configs:
  interval: 10s
  round_interval: "false"
  metric_batch_size: 5000
  metric_buffer_limit: 25000
  collection_jitter: 2s
  flush_interval: 5s
  flush_jitter: 2s
  debug: "true"
  quiet: "false"
  omit_hostname: "false"
  hostname: "{{ ansible_hostname }}"

# Telegraf Prometheus / Mimir remote write Output
prometheus_server_ip: 10.0.10.30
prometheus_default_url: http://{{ prometheus_server_ip }}:9009/api/v1/push
prometheus_data_format: prometheusremotewrite
prometheus_http_headers:
  - header: Content-Type
    value: application/x-protobuf
  - header: Content-Encoding
    value: snappy
  - header: X-Prometheus-Remote-Write-Version
    value: "0.1.0"

# Telegraf Loki / Mimir remote write Output
loki_server_ip: 10.0.10.30
loki_default_url: http://{{ loki_server_ip }}:3100
loki_endpoint: /loki/api/v1/push
loki_timeout: 30s
loki_metric_name_label: __name
#### Telegraf InfluxDB v2 Output
influxdb2_server_ip: 10.0.10.17
telegraf_influxdb2_default_url: http://{{ influxdb2_server_ip }}:8086

telegraf_output_plugins:
  # influxdb v2 output config
  - name: influxdb_v2
    options:
      urls:
        - "{{ telegraf_influxdb2_default_url }}"
      token: "{{ vault_influxdb2_telegraf_token }}"
      organization: constructorfleet
      bucket: telegraf
      exclude_bucket_tag: "true"
      timeout: 30s
      ping_timeout: 15s
      read_idle_timeout: 30s
      user_agent: telegraf
      content_encoding: gzip
      influx_uint_support: "false"
      tls_cert: "{{ ssl_cert_slurp_path }}"
      tls_key: "{{ ssl_key_slurp_path }}"
      insecure_skip_verify: "false"

# # Prometheus remote-write output config
# - name: http
#   options:
#     url: "{{ prometheus_default_url }}"
#     data_format: "{{ prometheus_data_format }}"
#     headers:
#       Content-Type: application/x-protobuf
#       Content-Encoding: snappy
#       X-Prometheus-Remote-Write-Version: "0.1.0"

# # Loki remote_write output config
# - name: loki
#   options:
#     domain: "{{ loki_default_url }}"
#     endpoint: "{{ loki_endpoint }}"
#     timeout: "{{ loki_timeout }}"

# # Base telegraf configuration override
telegraf_plugins_base:
  - name: system
  - name: cpu
    options:
      percpu: "true"
      totalcpu: "true"
      fieldexclude:
        - time_*
  - name: mem
  - name: net
  - name: nstat
    options:
      proc_net_netstat: /proc/net/netstat
      proc_net_snmp: /proc/net/snmp
      dump_zeros: "true"
  - name: netstat
  - name: disk
    options:
      ignore_fs:
        - autofs
        - binfmt_misc
        - bpf
        - ceph
        - cgroup2
        - configfs
        - debugfs
        - devpts
        - devtmpfs
        - efivarfs
        - hugetlbfs
        - mqueue
        - proc
        - pstore
        - ramfs
        - rpc_pipefs
        - securityfs
        - sysfs
        - tmpfs
        - tracefs
        - overlay
        - overlay2
        - nfs
        - nfs4
        - iso9660
  - name: diskio
    options:
      skip_serial_number: "false"
      devices:
        - sd*
        - rbd*
        - dm*
        - nvme*
  - name: swap
  - name: processes
  - name: kernel
  - name: kernel_vmstat
  - name: internal
  - name: sysstat
    options:
      sadc_interval: 5s
      interval: 60s
      sadc_path: "{{ '/usr/lib64/sa/sadc' if ansible_os_family == 'RedHat' else '/usr/lib/sysstat/sadc' if ansible_os_family == 'Debian' else 'sadc' }}"
      activities:
        - ALL
        - XALL
      group: "true"
      options:
        -C: cpu
        -B: paging
        -b: io
        -d: disk
        -H: hugepages
        -I ALL: interrupts
        -n ALL: network
        -P ALL: per_cpu
        -q: queue
        -r ALL: mem_util
        -S: swap_util
        -u: cpu_util
        -v: inode
        -W: swap
        -w: task
  - name: syslog
    options:
      server: tcp://:6514

####################################
####### Rsyslog Configuration ######
####################################

rsyslog_config: true
rsyslog_allow_tcp: true
rsyslog_allow_udp: true
rsyslog_localfiles:
  - name: /var/log/auth.log
    proto: file
    selectors: auth,authpriv.*
  - name: /var/log/syslog
    proto: nosync
    selectors:
      - "*.*"
      - auth,authpriv.none
  - name: /var/log/daemon.log
    selectors: daemon.*
  - name: /var/log/kern.log
    proto: nosync
    selectors: kern.*
  - name: /var/log/lpr.log
    proto: nosync
    selectors: lpr.*
  - name: /var/log/mail.log
    selectors: mail.*
  - name: /var/log/user.log
    selectors: user.*
  - name: /var/log/mail.info
    proto: nosync
    selectors: mail.info
  - name: /var/log/mail.warn
    proto: nosync
    selectors: mail.warn
  - name: /var/log/mail.err
    selectors: mail.err
  - name: /var/log/debug
    proto: nosync
    selectors:
      - "*.=debug"
      - auth,authpriv.none
      - mail.none
  - name: /var/log/messages
    proto: nosync
    selectors:
      - "*.=info"
      - "*.=notice"
      - "*.=warn"
      - auth,authpriv.none
      - cron,daemon.none
      - mail.none
rsyslog_devices:
  - name: :omusrmsg:*
    selectors: "*.emerg"
rsyslog_servers:
  - name: (o)127.0.0.1
    proto: tcp
    port: "6514"
    format: RSYSLOG_SyslogProtocol23Format
    selectors:
      - "*.*"
rsyslog_pri_domain_name: "{{ www_domain }}"
rsyslog_options:
  - $ActionQueueType LinkedList # use asynchronous processing
  - $ActionQueueFileName srvrfwd # set file name, also enables disk mode
  - $ActionResumeRetryCount -1 # infinite retries on insert failure
  - $ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down
  - $MaxMessageSize 64k

####################################
####### GRAFANA BACKUP CONFIGS #####
####################################

grafana_api_token: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  36306336616136616230313731333338323336376430303037303864343665343838346265313237
  3361393033333637616364396434636236376263663031390a616430373337613131663366396130
  61306365333331346261663237326230616338663730653766616537653834643965346164383630
  3134626138613630370a376532393261343033343464616163393436316666366438333931336332
  36303839653163313961316565663734386161666561626533323431323036333666616239623736
  32303334336131643033386337333363626266306465346330633138303131313930313234306232
  38333233363666386631666335393034393862653337623166373864393333353765633539653738
  37386463333436303363303336303862613230366261323865353133656632356535616538303063
  3430
grafana_domain: "{{ www_domain }}"
grafana_admin_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  65383333376331373864366132613331613130386235326232653438383532623238653638333765
  3837356266393232623066353330393165343062316563650a386332373739393832663663363232
  61376662373639356135323438373139663766616335376564376236616531636162643564323031
  6539343431333464350a313863316433646436313830623830613634666635643034373637336364
  3861

####################################
##### Unpoller Configuration #######
####################################

unifi_admin_site: "{{ www_domain }}"
unifi_admin_host: unifi-admin.{{ www_domain }}
unifi_admin_user: prometheus
unifi_admin_password: "{{ vault_unifi_admin_password }}"
unms_enable_ssl: true
unifi_enable_ssl: true
unifi_config_directory: "{{ data_mount_root }}/{{ configs_directory }}/unifi"
unifi_exporter_config_directory: "{{ data_mount_root }}/{{ configs_directory }}/unifi_exporter"
unifi_poller_config_directory: "{{ data_mount_root }}/{{ configs_directory }}/unifi-poller"

unifi_snmp_v3_username: telegraf
unifi_snmp_v3_password: "{{ vault_unifi_snmp_v3_password }}"

####################################
##### CEPH MEDIA CLUSTER CONF  #####
####################################

# Ceph vars used to generate ceph.conf and set up cephfs
ceph_release: reef
ceph_pkgs:
  - cephadm
  - ceph-common
ceph_client_pkgs:
  - chrony
  - ceph-common
infra_pkgs:
  - chrony
  - podman
cephadm_grafana_admin_pw: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  63336663303964396361663139613962323038383735383132356134383164646632646431386435
  3762366339633666306263613966613931393030396638340a313732313463313262656362613336
  65396130376262303233656336356663646161363730323263356363653931663063613032666531
  6639393661386633380a313662626237663133356439383331633930303066396537306139316161
  6165
cephadm_grafana_admin_user: admin
cluster: ceph
client_group: clients
delegate_facts_host: true
ceph_container_registry: quay.io
ceph_container_registry_auth: false
ceph_container_no_proxy: localhost,127.0.0.1
health_mon_check_retries: 300
health_mon_check_delay: 1
ceph_cluster_network: 10.0.10.0/24
ceph_public_network: 10.0.10.0/24
admin_node: ceph001
keyring_dest: /etc/ceph/ceph.client.admin.keyring
keyring: /etc/ceph/ceph.client.admin.keyring
fsid: 5edafde6-a3ad-11ee-8920-ac1f6b4e335a
conf: /etc/ceph/ceph.conf
cephadm_pull: true
local_client_dir: /workspaces/home-ansible-awx/include
cephadm_ssh_config: /root/.ssh/config
cephadm_allow_fqdn_hostname: true
cephadm_ssh_user: root
cephadm_allow_overwrite: true
cephadm_cmd: cephadm  shell -- ceph
cephadm_monitoring: true
cephadm_firewalld: true
cephadm_pubkey_path: "{{ local_client_dir }}/ceph.pub"
cephadm_dashboard: true
cephadm_dashboard_user: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  32353131663161633439656535653536313261313963663331383664333233323134636131343734
  3363363036626533636434343635653738333139353262340a323461663663366332666561303532
  64333131356632316434356136663665643333343035623930393137383839613335666533633733
  6632313839303536630a313630366562613030616638663363333037373739653064373262386237
  3730
cephadm_dashboard_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  32383237626433333666313331653336356362396465646639303561373461323838343066636337
  3266313539313237343533316137396132373234306236390a303032666230663162396630333337
  63313136663535656234336661623862656561626337383738373564653133326635653639353739
  3836623962303530650a373735376365646135653264303562326461646530363835303633663537
  6336
mon_hosts:
  - 10.0.10.101
  - 10.0.10.102
  - 10.0.10.103
  - 10.0.10.104
mon_host: >-
  {%- for host in groups['mons'] -%} [v2:{{ hostvars[host]['ansible_host'] }}:3300/0,v1:{{
  hostvars[host]['ansible_host'] }}:6789/0]{%- if not loop.last %} {% endif -%} {%- endfor -%}
cephadm_config_options:
  global:
    - name: cluster_network
      value: 10.0.10.0/24
      level: advanced
    - name: auth_client_required
      value: cephx
      level: advanced
    - name: auth_cluster_required
      value: cephx
      level: advanced
    - name: auth_service_required
      value: cephx
      level: advanced
    - name: auth_supported
      value: cephx
      level: advanced
    - name: bluestore_cache_autotune
      value: "true"
      level: dev
    - name: device_failure_prediction_mode
      value: local
      level: basic
    - name: mon_allow_pool_delete
      value: "true"
      level: advanced
    - name: osd_memory_target_autotune
      value: "true"
      level: advanced
    - name: osd_pool_default_pg_autoscale_mode
      value: "on"
      level: advanced
  mon:
    - name: public_network
      value: 10.0.10.0/24
      level: advanced

ceph_root_ssh_key: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  35323734316663356263653865393839303538316631336364316231336261613164373265313766
  6636633265343235643633653461356431656530613035380a663362643034633131666330333034
  32303166653733346437636264326536343930666134636439613862383830643861363037363636
  3666343832363661660a336432663565613339356663303632643232303435363265636138323139
  30366662333232323061346461663332353532343735313537356439346665646236393763393862
  63613065303338613136646138303239313936383337326461333866333136393664376534643136
  34633963643764383735316134323863323235333063383736343764663533363931363762623336
  33386434633861336162643535636662653434666264646237303962333666333339636563613336
  34366266656630326532366330363461353361636666663638386231316630333566626664636161
  35663364333933366561373063633933323930393237633462666431616664646266643531363230
  36623830666338643633666361383032326461313165663766326662613938333035333337633139
  31376633383132313538633732653732383636353535346364633233303966373830356465666233
  64303037623334376332323065616663376135623139313365386533666330376239383366336530
  33353835663935323634343066346232643361383132373738663664333135346132346430666236
  63623230393937376632376162363162343233313831616237613963626430313938623839373865
  62363938643735613135356130626233303738303963346536643066303631383664356165616336
  39366261316435363164373962613434373837376365383163633766626230303432393261303531
  62376437646438636134306331636334336536313730383537353664383265623536353536343536
  37333538353062343463343231373339386138346466363031623732393734653438623065316361
  63323939323036396562386362333665323439623361656461636665346237636639663437346531
  33636164356662653731643665326635303866303635646364303930613361633338363930343339
  36396137343163383166653537623531353130383065343266396264653533613435363562373539
  66636166663831303666383863346530386263383662653234383931663837646635336535363531
  38393030336339393461386261356262346666623361373533663933656138313365356434363566
  66366336363133636430633430316335663837386663356132373063396137383063666531363861
  64643631626362363064616539303438316337613862393736646632313363383237366361653662
  66623933326533393563363966313133333761343965656237613963353265663334333930396336
  37663061316632323337313035313438633464353930343765613630316233333861353131376261
  63353132363137666564653531666231393338346434363761636233653938636361

ceph_reef_cephfs_data_secret: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  66353938396633633231663962393132366334396437636264353162356465376637303363333837
  6664653264373035643332313666633962346465666431610a653061336165323931643338666261
  38303264363661653830653534646661343866626636663165373264353134643861363934366638
  6238636262623164650a376139653165653061623466303230303534343037663666636432343461
  34623266323736393238653963623138633739373831666166333361356238303764613330313463
  3262623734316536343233633165366161663438393566623764

ceph_reef_cephfs_data_secretfile: /etc/ceph/data.secret

ceph_cephfs_data_secret: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  31323964333765323232343562363861333138343363653531653766343663373531656136613033
  6466393333383636363563323564376164633462646363360a613036333335353865333535373835
  31363238336531363935643265666235613463343935316639336230666635366330363564323464
  6133383330633266610a613033376163383933323465353436373637383339316339636232376261
  32653739356435326131356233323266383438396565336262363932313535326136303431376631
  3665356361633932656633633863633230313537316231373665

ceph_cephfs_data_secretfile: /etc/ceph/dataold.secret

ceph_cephfs_media_secret: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  37363132303637353834306634646331623337396435323265323463373861623064643962653631
  3937343030333730383332326365336233666630313638610a643062336234383136663562306237
  65643534333266623430633434623566653561646637613835363366616132666533303562646266
  3831313763623061380a306433633237353366393864376536323164336432333862323731306565
  33366538363633656161333737393833353337356263316538633462633638366438333861323632
  3262323964623632393831343633646663613665386462666663

ceph_cephfs_media_secretfile: /etc/ceph/media.secret

ceph_cluster_admin_secret: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38303134613836623333386438663836306436646231323235633730646430396631323635353966
  6138363062653932363834643866326161653163366631370a656434613966356630323439353032
  34633538363164366337356562666362313266666331363436616563616462386134386235396431
  3436356635383531320a636631323865333235366237333233363662363437396639663533363631
  35323638326262393661653437336139363734346236626661323034613765393030383132643533
  3961643963353039353530643133653066613764626465616131

ceph_cluster_admin_keyring: /etc/ceph/ceph.client.admin.keyring
ceph_keyring_permissions: "0600"
ceph_mountconfig_directory: /opt/ceph
ceph_auth: cephx
ceph_cephfs_user: admin
ceph_cephfs_fsname: cephfs
ceph_cephfs_ms_mode: prefer-crc
ceph_cephfs_mds_port: 3300
ceph_cluster_admin: admin
ceph_copy_admin_key: true

# Ceph vars used ceph_mount:
cephfs_mounts:
  - mount: /data
    fsname: "{{ ceph_cephfs_fsname }}"
    fsid: 5edafde6-a3ad-11ee-8920-ac1f6b4e335a
    ms_mode: "{{ ceph_cephfs_ms_mode }}"
    mount_opts:
      - noatime
      - nodiratime
      - _netdev
    mon:
      - 10.0.10.101
      - 10.0.10.102
      - 10.0.10.103
      - 10.0.10.104
    port: "{{ ceph_cephfs_mds_port }}"
    user: "{{ ceph_cephfs_user }}"
    secret: "{{ ceph_reef_cephfs_data_secret }}"
    secretfile: "{{ ceph_reef_cephfs_data_secretfile }}"

  - mount: /media
    fsname: "{{ ceph_cephfs_fsname }}"
    fsid: df72f399-c211-4268-a81c-8206001991ad
    ms_mode: "{{ ceph_cephfs_ms_mode }}"
    mount_opts:
      - noatime
      - nodiratime
      - _netdev
    mon:
      - 10.0.10.201
      - 10.0.10.202
      - 10.0.10.203
      - 10.0.10.204
    port: "{{ ceph_cephfs_mds_port }}"
    user: "{{ ceph_cephfs_user }}"
    secret: "{{ ceph_cephfs_media_secret }}"
    secretfile: "{{ ceph_cephfs_media_secretfile }}"

cephfs_autofs_mount:
  mount: /homedirs
  fsname: "{{ ceph_cephfs_fsname }}"
  fsid: 5edafde6-a3ad-11ee-8920-ac1f6b4e335a
  ms_mode: "{{ ceph_cephfs_ms_mode }}"
  mount_opts:
    - noatime
    - nodiratime
    - _netdev
  mon:
    - 10.0.10.101
    - 10.0.10.102
    - 10.0.10.103
    - 10.0.10.104
  port: "{{ ceph_cephfs_mds_port }}"
  user: "{{ ceph_cephfs_user }}"
  secret: "{{ ceph_reef_cephfs_data_secret }}"
  secretfile: "{{ ceph_reef_cephfs_data_secret }}"

cephfs_mount_options: mon_addr={%- for host in cephfs_autofs_mount.mon | list -%}{{ host }}:{{ cephfs_autofs_mount.port }}{%- if not loop.last -%}/{%- endif -%}{%-
  endfor -%},ms_mode={{ cephfs_autofs_mount.ms_mode }},secret={{ cephfs_autofs_mount.secret }}{%- if cephfs_autofs_mount.mount_opts is defined -%},{{ cephfs_autofs_mount.mount_opts
  | list | join(',') }}{%- endif -%}
